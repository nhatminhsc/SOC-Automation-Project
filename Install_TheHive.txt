Install TheHive

#Dependencies
apt install wget gnupg apt-transport-https git ca-certificates ca-certificates-java curl software-properties-common python3-pip lsb-release


#install java
wget -qO- https://apt.corretto.aws/corretto.key | sudo gpg --dearmor -o /usr/share/keyrings/corretto.gpg
echo "deb [signed-by=/usr/share/keyrings/corretto.gpg] https://apt.corretto.aws stable main" | sudo tee -a /etc/apt/sources.list.d/corretto.sources.list
sudo apt update
sudo apt install java-common java-11-amazon-corretto-jdk
echo JAVA_HOME="/usr/lib/jvm/java-11-amazon-corretto" | sudo tee -a /etc/environment
export JAVA_HOME="/usr/lib/jvm/java-11-amazon-corretto"


#install Cassandra
wget -qO -  https://downloads.apache.org/cassandra/KEYS | sudo gpg --dearmor  -o /usr/share/keyrings/cassandra-archive.gpg
echo "deb [signed-by=/usr/share/keyrings/cassandra-archive.gpg] https://debian.cassandra.apache.org 41x main" |  sudo tee -a /etc/apt/sources.list.d/cassandra.sources.list
sudo apt update
sudo apt install Cassandra


#install elasticsearch
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch |  sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg
sudo apt-get install apt-transport-https
echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/7.x/apt stable main" |  sudo tee /etc/apt/sources.list.d/elastic-7.x.list
sudo apt update
sudo apt install elasticsearch


#File Storage
sudo mkdir -p /opt/thp/thehive/files
sudo groupadd --system thehive
sudo useradd --system --no-create-home --gid thehive --shell /bin/false thehive
chown -R thehive:thehive /opt/thp/thehive/files


#install TheHive
wget -O /opt/thp/thehive/files/thehive_5.5.7-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.7-1_all.deb
wget -O /opt/thp/thehive/files/thehive_5.5.7-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.7-1_all.sha256
wget -O /opt/thp/thehive/files/thehive_5.5.7-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.7-1_all.deb.asc


#Download the public key at keys.download.strangebee.com using Wget or cURL.
wget -O /opt/thp/thehive/files/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg


#Import the key into your GPG keyring
gpg --import /opt/thp/thehive/files/strangebee.gpg


#Verify the downloaded package signature.
gpg --verify /opt/thp/thehive/files/thehive_5.5.7-1_all.deb.asc /opt/thp/thehive/files/thehive_5.5.7-1_all.deb


#Install the package.
sudo apt-get install /opt/thp/thehive/files/thehive_5.5.7-1_all.deb

sudo rm /etc/apt/sources.list.d/strangebee.list
sudo apt-get update



